window.hooks=window.hooks||{},window.hooks.baseUrl="//insights.dowjones.net",window.hooks.commandUrl="//djibeacon.dowjoneson.com",String.prototype.hexEncode=function(){for(var c,a="",b=0,d=this.replace(/^[\u0080-\uffff]/g,"");b<d.length;)c=d.charCodeAt(b++).toString(16),c=c.length<2?"0"+c:c,a+=c;return a},String.prototype.hexDecode=function(){for(var a="",b=0;b<this.length;b+=2)a+=unescape("%"+this.substr(b,2));return a};var JSON;JSON||(JSON={}),function(){function k(a){return a<10?"0"+a:a}function o(a){return p.lastIndex=0,p.test(a)?'"'+a.replace(p,function(a){var b=r[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function l(a,b){var c,d,f,g,j,h=e,k=b[a];switch(k&&"object"==typeof k&&"function"==typeof k.toJSON&&(k=k.toJSON(a)),"function"==typeof i&&(k=i.call(b,a,k)),typeof k){case"string":return o(k);case"number":return isFinite(k)?String(k):"null";case"boolean":case"null":return String(k);case"object":if(!k)return"null";if(e+=n,j=[],"[object Array]"===Object.prototype.toString.apply(k)){for(g=k.length,c=0;c<g;c+=1)j[c]=l(c,k)||"null";return f=0===j.length?"[]":e?"[\n"+e+j.join(",\n"+e)+"\n"+h+"]":"["+j.join(",")+"]",e=h,f}if(i&&"object"==typeof i)for(g=i.length,c=0;c<g;c+=1)"string"==typeof i[c]&&(d=i[c],(f=l(d,k))&&j.push(o(d)+(e?": ":":")+f));else for(d in k)Object.prototype.hasOwnProperty.call(k,d)&&(f=l(d,k))&&j.push(o(d)+(e?": ":":")+f);return f=0===j.length?"{}":e?"{\n"+e+j.join(",\n"+e)+"\n"+h+"}":"{"+j.join(",")+"}",e=h,f}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+k(this.getUTCMonth()+1)+"-"+k(this.getUTCDate())+"T"+k(this.getUTCHours())+":"+k(this.getUTCMinutes())+":"+k(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var q=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,p=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,n,r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(n=e="","number"==typeof c)for(d=0;d<c;d+=1)n+=" ";else"string"==typeof c&&(n=c);if((i=b)&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw Error("JSON.stringify");return l("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(a,e){function c(a,b){var d,f,g=a[b];if(g&&"object"==typeof g)for(d in g)Object.prototype.hasOwnProperty.call(g,d)&&(f=c(g,d),void 0!==f?g[d]=f:delete g[d]);return e.call(a,b,g)}var d,a=String(a);if(q.lastIndex=0,q.test(a)&&(a=a.replace(q,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return d=eval("("+a+")"),"function"==typeof e?c({"":d},""):d;throw new SyntaxError("JSON.parse")})}(),function(){var a="undefined"!=typeof window?window:exports,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=function(){try{document.createElement("$")}catch(a){return a}}();a.btoa||(a.btoa=function(a){for(var d,e,f=0,g=b,h="";a.charAt(0|f)||(g="=",f%1);h+=g.charAt(63&d>>8-f%1*8)){if(e=a.charCodeAt(f+=.75),e>255)throw c;d=d<<8|e}return h}),a.atob||(a.atob=function(a){if(a=a.replace(/=+$/,""),a.length%4==1)throw c;for(var e,f,d=0,g=0,h="";f=a.charAt(g++);~f&&(e=d%4?64*e+f:f,d++%4)?h+=String.fromCharCode(255&e>>(-2*d&6)):0)f=b.indexOf(f);return h})}(),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments.length>=2?arguments[1]:void 0,f=0;f<c;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var e,b=Object(this),c=b.length>>>0,d=0;if(arguments.length>=2)e=arguments[1];else{for(;d<c&&!d in b;)d++;if(d>=c)throw new TypeError("Reduce of empty array with no initial value");e=b[d++]}for(;d<c;d++)d in b&&(e=a(e,b[d],d,b));return e}),function(a,b){var c=a._sf_async_config||{},d=3e4,e=0,f=20141010;Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1});var g=function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},h={};h.getLocation=function(){return a.location},h.getTitle=function(){return a.document.title},a.hooks.start=(new Date).getTime();var i=function(a,b){var c={};a=a||{},b=b||{};for(var d in a)c[d]=a[d];for(var e in b)c[e]=b[e];return c},j=function(a){for(var b={},c=0;c<a.attributes.length;c++){var d=a.attributes[c].name,e=a.attributes[c].value;b[d]=e}return b},k=function(a){var b,c;a.itemprop&&(b=a.itemprop),a.property&&(b=a.property),a.name&&(b=a.name),a.value&&(c=a.value),a.content&&(c=a.content);var d={};return d[b]=c,d};h.parseMetatags=function(a){for(var b=[{}],c=0;c<a.length;c++)b.push(k(j(a[c])));return b.reduce(i)},h.getQueryObject=function(){var b=a.hooks.getLocation().href.split("?")[1];if(!b)return{};for(var c=b.split("&"),d=[],e=0;e<c.length;e++)d.push(c[e].split("="));var f={};for(e=0;e<d.length;e++){var g=d[e][0],h=d[e][1];f[g]=h}return f};var l=function(a){var c=document.cookie.split(";"),d=new RegExp(a,"i"),e=c.filter(function(a){return d.test(a)});return e.length>0?(e=g(e[0]),e.split("=")[1]):b};h.getUser=function(){return l("remote_user")},h.getSVI=function(){return l("s_vi")},h.getCke=function(){return l("cke")};var m=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})};h.getDJIUser=function(){var a=l("dji_user");if(a)return a;var b=m();return document.cookie="dji_user="+b,b},h.getCurrentPage=function(){var b=a.hooks.getLocation().href,c=b.toString().split(a.hooks.getLocation().host)[1];return"/"==c&&(c="/index"),c.split("?")[0].split("#")[0]},h.wrapElement=function(a){var b=document.createElement("div");return b.innerHTML=a,b};var n=function(){return(new Date).getTime()};h.engageEvent=function(a){var b=this;b.name=a,b.lastEngaged=n(),o(a,function(a){b.lastEngaged=n()});var c=function(a,c){return Number(a)-Number(b.lastEngaged)<c};return{isEngaged:c}},h.engaged=function(){for(var b=["scroll","keydown","mousemove"],c=1e3,d=[],e=0;e<b.length;e++)d.push(a.hooks.engageEvent(b[e]));var f=function(a){for(var b=0;b<d.length;b++)if(d[b].isEngaged(n(),c))return!0;return!1};return{isEngaged:f}};var o=function(b,c){a.addEventListener?a.addEventListener(b,c,!1):document.attachEvent&&document.attachEvent("on"+b,c)};h.putTracker=function(b,c){var d={type:"djcs_info",value:{UUID:"test"}},e=i(h.getMetadata(),c),g=a.hooks.commandUrl+"/v1/event.gif?key="+a.btoa(unescape(encodeURIComponent(a.hooks.getCleanHref())))+"&v="+f+"&activityType="+b+"&user="+a.btoa(unescape(encodeURIComponent(JSON.stringify(d))))+"&data="+a.btoa(unescape(encodeURIComponent(JSON.stringify(e)))),j=new a.Image(1,1);j.src=g};var p=function(a){if(!a||""===a)return"";var b=document.createElement("a");return b.href=a,b.hostname};h.getConfigData=function(){return a.dji_config||{}};var q={x:-1,y:-1};o("mousemove",function(b){b=b||a.event,q={x:b.clientX,y:b.clientY}}),h.getMetadata=function(){var b={hostname:a.hooks.getLocation().hostname,page:a.hooks.getCurrentPage(),referrerHostname:p(document.referrer),referrer:document.referrer,queryObject:a.hooks.getQueryObject(),metaTags:a.hooks.parseMetatags(document.getElementsByTagName("meta")),title:a.hooks.getTitle(),mouse:q,top:a.hooks.getTop(),left:a.hooks.getLeft(),width:a.hooks.getWidth(),user:a.hooks.getUser(),dji_user:a.hooks.getDJIUser(),s_vi:a.hooks.getSVI(),cke:a.hooks.getCke(),height:a.hooks.getHeight(),ua:a.navigator.userAgent};return b=i(b,a.hooks.getConfigData()),c&&(b._sf_async_config=c),b},h.getTop=function(){return a.pageYOffset?a.pageYOffset:document.body?document.body.scrollTop:document.documentElement?document.documentElement.scrollTop:0},h.getLeft=function(){return a.pageYOffset?a.pageXOffset:document.body?document.body.scrollLeft:document.documentElement?document.documentElement.scrollLeft:0},h.getHeight=function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)||0},h.getWidth=function(){return Math.max(document.body.scrollWidth,document.documentElement.scrollWidth)||0};var r=function(){var b=[],c=0,f=a.hooks.engaged(),g=0,h=function(){var h=f.isEngaged(n());if(h&&e++,b.push(h),b.length>d/1e3){for(var i=0;i<b.length;i++)b[i]&&c++;a.clearInterval(g)}};g=a.setInterval(h,1e3)};h.sendLoad=function(){a.hooks.putTracker("load",{})},h.getCleanHref=function(){return a.hooks.getLocation().href.replace(a.hooks.getLocation().hash,"")};var s=function(){var b=(new Date).getTime(),c='<link href="'+a.hooks.baseUrl+"/css/overlay.css?v="+b+'" rel="stylesheet" type="text/css" />';document.body.appendChild(a.hooks.wrapElement(c));var d=document.createElement("script");d.src=a.hooks.baseUrl+"/scripts/overlay.js?v="+b,d.async=!0,document.body.appendChild(d)};o("mousedown",function(b){b=b||a.event;var c=b.target||b.srcElement;if(c&&c.href){var d=document.getElementsByTagName(c.tagName),e=a.hooks.getCurrentPage();e=e.split("?")[0];var f={href:c.href.split("?")[0],textContent:encodeURIComponent(c.outerText.trim()),index:Array.prototype.indexOf.call(d,c)};a.hooks.putTracker("click",f)}}),o("beforeunload",function(b){var d=(a.hooks.getCurrentPage(),n()),f={totalEngagedSeconds:e,value:d-a.hooks.start};a.hooks.putTracker("timeSpent",f)}),"object"==typeof a&&"object"==typeof a.document&&(a.hooks=i(a.hooks,h)),a.parent&&(a.parent.postMessage({href:a.hooks.getLocation().href,activityType:"init"},"*"),o("message",function(b){if(b=b||a.event,b&&/dj-overlay/.test(b.origin)||/dj-insights/.test(b.origin)||/insights.dowjones.net/.test(b.origin))switch(b.data.activityType){case"init_overlay":b.data.baseUrl&&(a.hooks.baseUrl=b.data.baseUrl),s(),a.clearInterval(this.pingIntervalId)}})),h.sendLoad(),r();a.setInterval(r,d)}(window);